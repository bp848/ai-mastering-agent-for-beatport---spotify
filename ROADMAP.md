# 製品ロードマップ

## 全体フロー

```
[1] 本体リリース（日本語＋多言語）＋離脱分析 ＋ Nulled対策
         ↓
[2] CodeCanyon で本体のみ販売（Extended）
         ↓
    結果がよければ
         ↓
[3] CodeCanyon で SaaS Ready 版販売
[4] ジャンル横展開（CodeCanyon 別売り）
[5] API 版リリース
```

---

## Phase 1: 本体リリース優先

**ゴール**: 日本語版＋多言語で本体をリリースし、ユーザー離脱ポイントを把握する。

### やること
- [ ] 日本語・英語（＋必要なら他言語）のUI/文言を完成させる
- [ ] 本番デプロイ（Vercel / Netlify / 自前など）
- [ ] **離脱ポイント計測**
  - どこで離脱するか: アップロード直後 / Pyodide ロード待ち / 分析中 / 決済・ダウンロード前 など
  - ツール: Google Analytics 4（イベント）、Hotjar/Microsoft Clarity（セッション録画）、または Supabase でキー操作をログ

### Nulled サイト対策
- **ライセンス検証**: 購入者に配布するバイナリ/コードに、ライセンスキー or ドメイン検証を組み込む（CodeCanyon の購入証明と連携）
- **難読化・保護**: 重要ロジック（マスタリングパラメータ計算、APIキー周り）は可能な範囲で難読化 or サーバー側に寄せる
- **APIキーをクライアントに直書きしない**: Gemini 等はバックエンド/Edge Function 経由にし、Nulled 版では「キー未設定」で動かないようにする
- **ドメイン/環境チェック**: 本番ドメイン以外では制限 or 警告を出す（オフライン利用版を売る場合は別設計）

---

## Phase 2: CodeCanyon で本体のみ販売（Extended）

**ゴール**: 買い切り「本体」を Extended ライセンスで販売。売上・レビューで検証。

### やること
- [ ] 商品ページ用の説明文・スクショ・デモURL（多言語）
- [ ] Regular / Extended の価格設定（例: 単体 10万 / SaaS用 20万 相当）
- [ ] 配布パッケージ: ソース＋README＋環境構築手順・.env 例
- [ ] ライセンスチェックの仕様確定（Phase 1 の Nulled 対策と整合）

### 成功の目安
- 売上・レビューが「よい」→ Phase 3 へ
- フィードバックを元に改善してから Phase 3

---

## Phase 3: CodeCanyon で SaaS Ready 版販売

**条件**: Phase 1・2 の結果がよいこと。

**ゴール**: 購入者が自前ドメインで「マスタリングSaaS」を運営できるパッケージを販売。

### やること
- [ ] 認証（Supabase Auth 等）・課金（Stripe 等）・テナント分離のひな型
- [ ] 管理画面（ユーザー一覧・使用量・プラン）の最小セット
- [ ] インストール・環境変数・デプロイ手順のドキュメント
- [ ] CodeCanyon では「SaaS Ready」「White Label」などをキーワードで訴求

---

## Phase 4: ジャンル横展開（CodeCanyon 別売り）

**ゴール**: 同じ基盤でジャンル別プロファイルを変えた製品を別商品として販売。

| 商品例       | 差分 |
|-------------|------|
| ダンスミュージック版 | ターゲット LUFS/ピーク、プロンプト・ジャンル文脈を Dance/EDM 用に変更 |
| ロック版     | ロック向けの標準・プロンプト・プリセット |
| HipHop版    | HipHop/R&B 向けの標準・プロンプト・プリセット |

### やること
- [ ] ジャンル別「ターゲット標準」と AI プロンプトのプリセット化
- [ ] ブランディング・説明文をジャンルごとに変更したリポジトリ or ビルド分岐
- [ ] CodeCanyon では「Rock Mastering」「HipHop Mastering」などで別リスト

---

## Phase 5: API 版リリース

**ゴール**: マスタリング（＋必要なら分析）を API で提供。Supabase でキー管理・使用量・従量課金。

### やること
- [ ] Supabase: `api_keys` / `api_usage` テーブル、Edge Function でキー検証・使用量記録
- [ ] エンドポイント: 例 `POST /mastering`（音声 or URL → マスタリング結果 or 処理済みファイル）
- [ ] 料金プラン: 従量（○円/回）or 月額＋従量
- [ ] ドキュメント: 認証・リクエスト形式・レート制限・エラーコード
- [ ] 販売は CodeCanyon の「API add-on」or 自社サイトのサブスク

---

## チェックリスト（Phase 1 用・離脱ポイント）

離脱しやすいポイントを事前にリストしておく。

| ポイント               | 計測方法の例                          |
|------------------------|----------------------------------------|
| Pyodide ロード前で閉じる | ページビュー → 「pyodide_ready」イベントまで |
| ファイル選択せず離脱   | 「file_selected」が無いセッション       |
| 分析中に離脱           | 「analysis_start」→「analysis_done」の有無 |
| 提案取得前に離脱       | 「gemini_request」→「gemini_success」   |
| ダウンロード／購入前   | 「download_click」or 決済開始イベント   |

これらを GA4 や Supabase のイベントテーブルで計測すると、Phase 1 の「離脱ポイント」が数値で見える。
